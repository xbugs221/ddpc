[tox]
envlist = py{37,38,39,310,311,312,313,314}
skip_missing_interpreters = true

[testenv]
deps =
    -e .[full,dev]

# Set environment variables for better test isolation
setenv =
    PYTHONPATH = {toxinidir}/src
    PYTHONIOENCODING = utf-8

# Allow external commands
allowlist_externals =
    pytest
    ruff

commands =
    pytest tests/ -v --tb=short --cov=src/ddpc --cov-report=term-missing --cov-report=xml
    ruff check src/ tests/
    ruff format --check src/ tests/

# Install system dependencies on Linux
passenv =
    CI
    GITHUB_*
    HDF5_*
    LD_LIBRARY_PATH

[testenv:py37]
basepython = python3.7

[testenv:py38]
basepython = python3.8

[testenv:py39]
basepython = python3.9

[testenv:py310]
basepython = python3.10

[testenv:py311]
basepython = python3.11

[testenv:py312]
basepython = python3.12

[testenv:py313]
basepython = python3.13

[testenv:py314]
basepython = python3.14
